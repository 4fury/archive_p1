--- libs/lensfun/CMakeLists.txt.pkgconfig	2012-02-12 19:19:39.000000000 +0800
+++ libs/lensfun/CMakeLists.txt	2012-09-08 15:35:41.654073909 +0800
@@ -26,3 +26,11 @@
         RUNTIME DESTINATION ${BINDIR}
         LIBRARY DESTINATION ${LIBDIR}
         ARCHIVE DESTINATION ${LIBDIR})
+
+set(CONF_VERSION ${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_MICRO})
+set(CONF_LIBDIR ${LIBDIR})
+set(CONF_INCLUDEDIR ${CMAKE_INSTALL_PREFIX}/include)
+
+configure_file(lensfun.pc.in ${CMAKE_CURRENT_BINARY_DIR}/lensfun.pc)
+install(FILES ${CMAKE_CURRENT_BINARY_DIR}/lensfun.pc
+	DESTINATION ${LIBDIR}/pkgconfig)
--- CMakeLists.txt.pkgconfig	2012-11-16 16:43:44.642505859 -0500
+++ CMakeLists.txt	2012-11-16 16:50:00.503317741 -0500
@@ -125,7 +125,7 @@
 ENDIF()
 
 # install include files
-INSTALL(FILES ${CMAKE_BINARY_DIR}/lensfun.h DESTINATION ${INCLUDEDIR}/lensfun)
+INSTALL(FILES ${CMAKE_BINARY_DIR}/lensfun.h DESTINATION ${INCLUDEDIR})
 IF(NOT HAVE_REGEX_H)
   INSTALL(FILES include/regex/regex.h DESTINATION ${INCLUDEDIR}/regex)
 ENDIF()
